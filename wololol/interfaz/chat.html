<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
        <title>Wololol</title>

        <!-- CSS  -->
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection">
        <link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection">
    </head>
    <body>
        <nav class="blue" role="navigation">
            <div class="nav-wrapper container">

                <a id="logo-container" href="#" class="white-text brand-logo">Wololol</a>
                <ul class="right hide-on-med-and-down">
                    <div class="tooltipped left input-field" data-position="bottom" data-delay="50" data-tooltip="Ingrese nombre de invocador a buscar">
                        <input id="search" placeholder="Summoner Name" type="search" required>
                        <label for="search"><i class="material-icons">search</i></label>
                        <i class="material-icons">close</i>
                    </div>
                    <li class="active waves-effect waves-cyan"><a href="index.html" class="tooltipped" data-position="bottom" data-delay="50" data-tooltip="Información de perfil de un usuario"><i class="white-text material-icons">person_pin</i></a></li>
                    <li class="waves-effect waves-cyan"><a href="curriculum.html" class="tooltipped" data-position="bottom" data-delay="50" data-tooltip="Sección de chat, debe loguearse"><i class="white-text material-icons">chat</i></a></li>
                    <li class="waves-effect waves-cyan"><a href="contacto.html" class="tooltipped" data-position="bottom" data-delay="50" data-tooltip="Información estática del juego"><i class="white-text material-icons">dashboard</i></a></li>
                    <li class="waves-effect waves-cyan"><a href="contacto.html" class="white-text tooltipped" data-position="bottom" data-delay="50" data-tooltip="El 14/10/15, a partir de las 02:30 de Buenos Aires / 02:30 de Santiago, se desactivarán las colas clasificatorias en preparación para la actualización 5.20. A las 04:00 de Buenos Aires / 04:00 de Santiago, se apagarán los servidores y todas las partidas en curso terminarán en empate y no se guardarán datos de las mismas. Estimamos que los campos de batalla no estarán disponibles por 3 horas."><i class="left white-text material-icons">check_box</i>Online</a></li>

                    <li class="waves-effect waves-cyan"><a href="contacto.html" class="tooltipped" data-position="bottom" data-delay="50" data-tooltip="Ingresar al sistema"><i class="white-text material-icons">arrow_forward</i></a></li>

                </ul>


                <ul style="left: -27px;" id="nav-mobile" class="blue side-nav">
                    <li class=""><a href="index.html" class="waves-effect waves-cyan tooltipped" data-position="right" data-delay="50" data-tooltip="Información de perfil de un usuario"><i class="white-text material-icons">person_pin</i></a></li>
                    <li class="active"><a href="curriculum.html" class="waves-effect waves-cyan tooltipped" data-position="right" data-delay="50" data-tooltip="Sección de chat, debe loguearse"><i class="white-text material-icons">chat</i></a></li>
                    <li class=""><a href="contacto.html" class="waves-effect waves-cyan tooltipped" data-position="right" data-delay="50" data-tooltip="Información estática del juego"><i class="white-text material-icons">dashboard</i></a></li>
                    <li class=""><a href="contacto.html" class="waves-effect waves-cyan tooltipped" data-position="right" data-delay="50" data-tooltip="Ingresar al sistema"><i class="white-text material-icons">arrow_forward</i></a></li>
                </ul>
                <a  class="waves-effect waves-cyan circle button-collapse" style="margin:0 0 0 -10%;" href="#" data-activates="nav-mobile"><i class="material-icons">menu</i></a>
            </div>
        </nav>

        <div class="section">
            <div class="container">
                <div class="darkblue row">
                    <div style="display: block;" id="chat" class="darkblue col s12">

                        <div style="overflow-y: scroll;" id="contactos" class="hide-on-med-and-down darkblue text-white col s4">
                            <ul id="contactList" class="collection" data-collapsible="accordion" style="border:0px;">
                            </ul>
                        </div>
                        <div id="chatBox" class="col s8">
                            <div id="dlog-default" class="conversacion card blue text-white pad">
                                <h5 class="valign">Selecciona algún contacto para chatear!</h5>
                            </div>
                            <div class="card row s11 lightblue pad">
                                <div id="inputChat" class="col s11 lightblue input-field pad">
                                    <input id="chatText" type="text" value="">
                                </div>
                                <a id="send" class="waves-effect waves-light btn mid col s1" style="height:inherit"><i class="material-icons left">send</i></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <footer class="page-footer blue">
                <div class="container">
                    <div class="row">
                        <div class="col l6 s12">
                            <h5 class="white-text">Company Bio</h5>
                            <p class="grey-text text-lighten-4">We are a team of college
                                students working on this project like it's our full time job. Any amount
                                would help support and continue development on this shit project and is
                                greatly appreciated.</p>


                        </div>
                        <div class="col l3 s12">
                            <h5 class="white-text">Settings</h5>
                            <ul>
                                <li><a class="white-text" href="#%21">Link 1</a></li>
                                <li><a class="white-text" href="#%21">Link 2</a></li>
                                <li><a class="white-text" href="#%21">Link 3</a></li>
                                <li><a class="white-text" href="#%21">Link 4</a></li>
                            </ul>
                        </div>
                        <div class="col l3 s12">
                            <h5 class="white-text">Connect</h5>
                            <ul>
                                <li><a class="white-text" href="#%21">Link 1</a></li>
                                <li><a class="white-text" href="#%21">Link 2</a></li>
                                <li><a class="white-text" href="#%21">Link 3</a></li>
                                <li><a class="white-text" href="#%21">Link 4</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="footer-copyright">
                    <div class="container">
                        Made by WoloTeam<a class="brown-text text-lighten-3" href="http://materializecss.com/">Materialize</a>
                    </div>
                </div>
            </footer>


            <!--  Scripts-->
            <script type="text/javascript" src="js/jquery-2.1.1.min.js"></script>
            <script type="text/javascript" src="js/materialize.min.js"></script>
            <script src="js/init.js"></script>


            <div class="hiddendiv common"></div><div style="left: 0px;" class="drag-target"></div>

        </div>
    </body>

</html>
<script>
    $(document).ready(function(){
        var userName = "";
        //TODO MAYO, crear el usuario que maneja el chat con agregUser
        agregUser("06","Sad Jocker King","img/612.png","30","Gold V","MontaUrfs de Orianna","243","MaTeOeSeKaOcHo");

        $("#saveChanges").click(function(){
            //TODO MAYO: Esto guarda el mensaje de Chat del usuario
        });

        //TODO MAYO, crear los contactos con agregContact
        agregContact("01","Ωω.ΆΈ. ΉΊ","img/612.png","42","Silver VI","AguanteTurquia","653","Normal","En Juego","13 horas","ThU HeNbIdIah AzE Mih EghO");
        agregContact("02","Ωsdsω.ΆΈ. ΉΊ","img/612.png","42","Silver VI","AguanteTurquia","653","Normal","En Juego","13 horas","ThU HeNbIdIah AzE Mih EghO");
        agregContact("07","Ωsdsω.ΆΈ. ΉΊ","img/612.png","42","Silver VI","AguanteTurquia","653","Normal","En Juego","13 horas","ThU HeNbIdIah AzE Mih EghO");
        $("#contactos").height($(window).height()-100);
        $(".conversacion").height($(window).height()-180);

        changeProperty("07", "profileImage" , "img/92.png");

        if ( $("#contactos").css('display') == 'none' ){
            $("#chat").prepend('<button id="hiddenBtn" type="submit" class="btn-floating blue btn-flat waves-effect right mid"><i class="material-icons">send</i></button>');
            $("#chat").append('<div id="modalContacts" class="likemodal blue borderBlue white-text" style="position:fixed"><div id="contactsHere"></div><div class="blue s12"><hr><a id="closeContacts" class="right white-text waves-effect waves-green btn-flat">OK</a></div></div>');
            $('#modalContacts').hide();
            //$("#contactList").appendTo("contactsHere");
            $("#contactList").detach().appendTo('#contactsHere')
            $("#modalContacts").height($(window).height()-100);
            $("#modalContacts").width($(window).width()-100);

            $("#hiddenBtn").click(function(){
                $('#modalContacts').fadeIn( "slow");
            });
            $("#closeContacts").click(function(){
                $('#modalContacts').fadeOut( "slow");
            });
            $("#chatBox").removeClass("s8");
            $("#chatBox").addClass("s12");
        }
        function delContact(id){
            // TODO probar si anda
            $("#l"+id).remove();
            $("#ma"+id).remove();
        }

        function changeProperty(id, property, value){
            //property: name,statusChat,profileImage,level,league,promo,score,GQT,status,time,statusMsg
            //statusChat: connected = online(green), do not disturb = dnd(red), away = away(yellow)
            // TODO que funcione para cambiar propiedades al usuario y no solo a los contatos
            switch(property) {
                case "name":
                    $("#name"+id).text(value);
                    $("#nameH"+id).text(value);
                    break;
                case "statusChat":
                    $("#stat"+id).removeClass("green-text red-text yellow-text");
                    switch(value) {
                        case "online":
                            $("#stat"+id).addClass("green-text");
                            break;
                        case "dnd":
                            $("#stat"+id).addClass("red-text");
                            break;
                        case "away":
                            $("#stat"+id).addClass("yellow-text");
                            break;
                        default:
                            console.log("wololololol");
                            break;
                    }
                    break;
                case "profileImage":
                    imgLittle= "chatImg"+id;
                    imgLarge="profileImage"+id;
                    document.getElementById(imgLittle).src=value;
                    document.getElementById(imgLarge).src=value;
                    break;
                case "level":
                    $("#level"+id).text(value);
                    break;
                case "league":
                    $("#league"+id).text(value);
                    break;
                case "promo":
                    $("#promo"+id).text(value);
                    break;
                case "score":
                    $("#score"+id).text(value);
                    break;
                case "GQT":
                    $("#GQT"+id).text(value);
                    break;
                case "status":
                    switch(value) {
                            //Revisar si estos values son correctos
                        case "inGame":
                            $("#status"+id).text("En Juego");
                            break;
                        case "outOfGame":
                            $("#status"+id).text("Fuera de Juego");
                            break;
                        case "champSelect":
                            $("#status"+id).text("Seleccionando campeón");
                            break;
                        case "hostingNormalGame":
                            $("#status"+id).text("Creando Partida Normal");
                            break;
                        default:
                            console.log("wololololol");
                            break;
                    }
                    break;
                case "time":
                    if (value==null){
                        $("#GQT"+id).hide();
                    }else{
                        $("#GQT"+id).text(value);
                    }
                    break;
                case "statusMsg":
                    $("#statusMsg"+id).text(value);
                    break;
                default:
                    console.log("Ha ocurrido un error inesperado... inesperado... como el viaje de Bilbo");
                    break;
            }
        }

        function agregUser(id,name,profileImage,level,league,promo,score,statusMsg){
          // TODO no funciona el modal
            userName=name;
            $("#contactList").prepend($('<li/>', {
                'id': "perfil",
                html : $('<img id="chatImg'+id+'" class="mid chatImg" src="img/612.png" width="40px"/><span id="name'+id+'" class="white-text nameChat">'+name+'</span><i id="estado" class="material-icons right green-text">lens</i><a id="a'+id+'" class="modal-trigger right" data-target="#ma'+id+'"><i class="waves-effect waves-light material-icons">info</i></a>'),
                'class' : 'collection-item borderBlue',
                'style': 'border-bottom:0px;'
            }));

            var profileLarge = '<img id="profileImage'+id+'" src="'+profileImage+'" width="80px" style="border-radius:50px"/><br>';
            var level = '<span class="blue-text">Nivel: </span><span id="level'+id+'">'+level+'</span><br>';
            var league = '<span id="league'+id+'">'+league+'</span><br>';
            var promo = '<span id="promo'+id+'">'+promo+'</span><br>';
            var score = '<i class="material-icons mid tiny">grade</i><span id="score'+id+'">'+score+'</span><br>';
            var statusMsg = '<div class="row"><div class="input-field col s12"><input value="'+statusMsg+'" id="statusMsg'+id+'" type="text"></div></div>';

            $("#contactList").append('<div id="ma'+id+'" class="modal blue borderBlue white-text" style="position:fixed;z-index: 2004"><div class="modal-content"><h4 id="nameH'+id+'" class="col s12">'+name+'</h4><div class="card lightblue col s12 m12 l3 center" style="padding:10px">'+profileLarge+league+promo+'</div><div class="col l9 s12 m12">'+level+score+statusMsg+'</div></div><div class="blue modal-footer"><hr><a id="saveChanges" class="modal-action modal-close white-text waves-effect waves-green btn-flat">OK</a></div></div>');

        }

        function agregContact(id,name,profileImage,level,league,promo,score,GQT,status,time,statusMsg){
          // TODO no funcionan los modals
            // ITEM EN LISTA DE CONTACTOS: li id = l1090
            // MODAL DEL ITEM: m1090
            $("#contactList").append($('<li/>', {
                'id': 'l'+id,
                html : $('<img id="chatImg'+id+'" class="mid chatImg" src="'+profileImage+'" width="40px"/><span id="name'+id+'" class="white-text nameChat">'+name+'</span><i id="stat'+id+'" class="material-icons right green-text">lens</i><a id="a'+id+'" class="waves-effect circle waves-light modal-trigger right" data-target="#m'+id+'"><i class="material-icons">info</i></a>'),
                'class' : 'contact collection-item blue borderBlue',
                'style': 'border-bottom:0px;'
            }));

            var profileLarge = '<img id="profileImage'+id+'" src="'+profileImage+'" width="80px" style="border-radius:50px"/><br>';
            var level = '<span class="blue-text">Nivel: </span><span id="level'+id+'">'+level+'</span><br>';
            var league = '<span id="league'+id+'">'+league+'</span><br>';
            var promo = '<span id="promo'+id+'">'+promo+'</span><br>';
            var score = '<i class="material-icons mid tiny">grade</i><span id="score'+id+'">'+score+'</span><br>';
            var GQT = '<span id="GQT'+id+'">'+GQT+'</span><br>';
            var status = '<span id="status'+id+'" class="yellow-text">'+status+'</span><br>';
            var time = '<span id="time'+id+'">'+time+'</span><br>';
            var statusMsg = '<span id="statusMsg'+id+'" class="yellow-text" style="font-style:italic;font-size:20px">"'+statusMsg+'"</span><br>';

            $("#contactList").append('<div id="ma'+id+'" class="modal blue borderBlue white-text" style="position:fixed;z-index: 2004"><div class="modal-content"><h4 id="nameH'+id+'" class="col s12">'+name+'</h4><div class="card lightblue col s12 m12 l3 center" style="padding:10px">'+profileLarge+league+promo+'</div><div class="col l9 s12 m12">'+level+score+GQT+status+time+statusMsg+'</div></div><div class="blue modal-footer"><hr><a class="modal-action modal-close white-text waves-effect waves-green btn-flat">OK</a></div></div>');

        }
        var clickedTimes=1;

        $("#estado").click(function(){
            $(this).removeClass( "red-text yellow-text green-text" );
            switch (clickedTimes){
                case 0:
                    $('#estado').addClass("green-text");
                    break;
                case 1:
                    $('#estado').addClass("yellow-text");
                    break;
                case 2:
                    $('#estado').addClass("red-text");
                    break;
                default:
                    $('#estado').addClass("green-text");
                    break;
            }
            clickedTimes=clickedTimes+1;
            if (clickedTimes>=3){
                clickedTimes=0;
            }
        });


        $(".contact").click(function(){
            tabID=$(this).attr('id');
            $(".contact").removeClass("lightblue");
            $(".contact").removeClass("contActive");
            $(this).addClass("lightblue");
            $(this).addClass("contActive");
            $(".conversacion").hide();
            if ( $( "#dlog-"+tabID ).length ) {
                $("#dlog-"+tabID).show();
            }else{
                $("#chatBox").prepend('<div id="dlog-'+tabID+'" class="conversacion card blue text-white pad"></div>');
            }
            clsInputChat();
            $(".conversacion").height($(window).height()-180);
        });

        function incomeMsg(from,name,msgFrom){
            //from = ID del contact. Ej:2396937
            from="l"+from;
            $("#dlog-"+from).append('<div class="section"><span class="nameChat">'+name+'</span><br><p class="messageChat">'+msgFrom+'</p></div><hr>');
        }

        function clsInputChat(){
            $("#chatText").val("");
        }

        $('.modal-trigger').click(function(){
            name=$(this).attr('id');
            $('#m'+name).openModal();
        });

        $("#send").click(function (){
            var msg = $("#chatText").val();
            clsInputChat();
            if ($(".contact").hasClass("contActive")){
                if (msg==""){
                    alert("Debes escribir algo")
                }else{
                    msgTo=$(".contActive").attr('id');
                    $("#dlog-"+msgTo).append('<div class="section"><span class="nameChat">'+userName+'</span><br><p class="messageChat">'+msg+'</p></div><hr>');
                }
            }else{
                alert("Selecciona un contacto")
            }
        });
    });
</script>
